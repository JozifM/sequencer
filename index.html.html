<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" type="text/css" href="sequencer.css">
    <title>sequencer</title>

    <script src="ToneR7.js"></script>
    <script src="ToneR11.js"></script>
    <script src="nexusUI-v1.js"></script>
    <script src="nexusUI-v2.js"></script>

</head>
<body>

<select id="countries" onchange="countryList()">
	<option value="0">Western</option>
	<option value="1">African</option>
	<option value="2">Aisa</option>
	<option value="3">African</option>
</select>

<input type="range" min="0" max="1" value="0" class="slider" id="effect1">
<input type="range" min="0" max="100" value="0" class="slider" id="effect2">
<input type="range" min="0" max="100" value="0" class="slider" id="effect3">

 <!-- <div id = "menu"> -->
    <!-- <ul> -->
        <!-- <li>Western</li> -->
        <!-- <li>Aisa -->
            <!-- <ul> -->
                <!-- <li>India</li> -->
                <!-- <li>China</li> -->
                <!-- <li>Japan</li> -->
            <!-- </ul> -->
        <!-- </li> -->
        <!-- <li>Africa</li> -->
        <!-- <li>Latin America</li> -->
    <!-- </ul> -->
  <!-- </div> -->

<div id="boxArea">
	<input type="range" min="-48" max="0" value="-6" class="slider" id="volume1">
  <div class = "row" id = "kick">
  	<!-- <canvas nx="toggle" label="mute" value="1" id="mute"></canvas> -->
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <h2>Kick</h2>
   </div>
   <input type="range" min="-48" max="0" value="-6" class="slider" id="volume2">
  <div class = "row" id = "snare">
  	<!-- <canvas nx="toggle" label="mute" value="2" id="mute"></canvas> -->
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <h2>Snare</h2>
   </div>
   <input type="range" min="-48" max="0" value="-6" class="slider" id="volume3">
  <div class = "row" id = "hat">
  	<!-- <canvas nx="toggle" label="mute" value="3" id="mute"></canvas> -->
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <h2>Hat</h2>
   </div>
   <input type="range" min="-48" max="0" value="-6" class="slider" id="volume4">
   <div class = "row" id = "tom2">
   	<!-- <canvas nx="toggle" label="mute" value="4" id="mute"></canvas> -->
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <h2>Tom1</h2>
   </div>
   <input type="range" min="-48" max="0" value="-6" class="slider" id="volume5">
   <div class = "row" id = "tom3">
   	<!-- <canvas nx="toggle" label="mute" value="5" id="mute"></canvas> -->
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <h2>Tom2</h2>
   </div>
   <input type="range" min="-48" max="0" value="-6" class="slider" id="volume6">
   <div class = "row" id = "tom4">
   	<!-- <canvas nx="toggle" label="mute" value="6" id="mute"></canvas> -->
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <h2>Tom3</h2>
   </div>
   <input type="range" min="-48" max="0" value="-6" class="slider" id="volume7">
   <div class = "row" id = "crash">
   	<!-- <canvas nx="toggle" label="mute" value="7" id="mute"></canvas> -->
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <input type="checkbox" class="box"/>
    <h2>Crash</h2>
   </div>
 </div>

 <div id="controlsArea">
    <canvas nx="toggle" label="start/stop" id="play"></canvas>
  </div>
<script>
    
console.clear();

nx.onload = function() {
        // and event listener for all events on the toggle button
        play.on("*", toggleActions1);
        toggle2.on("*", mute);
    }

    var slider1 = document.getElementById("volume1");
    var slider2 = document.getElementById("volume2");
    var slider3 = document.getElementById("volume3");
    var slider4 = document.getElementById("volume4");
    var slider5 = document.getElementById("volume5");
    var slider6 = document.getElementById("volume6");
    var slider7 = document.getElementById("volume7");



// Update the current slider value (each time you drag the slider handle)
slider1.oninput = function() {
	samples[0].volume.value = slider1.value;
}
slider2.oninput = function() {
	samples[1].volume.value = slider2.value;
}
slider3.oninput = function() {
	samples[2].volume.value = slider3.value;
}
slider4.oninput = function() {
	samples[3].volume.value = slider4.value;
}
slider5.oninput = function() {
	samples[4].volume.value = slider5.value;
}
slider6.oninput = function() {
	samples[5].volume.value = slider6.value;
}
slider7.oninput = function() {
	samples[6].volume.value = slider7.value;
}

	var mod1 = document.getElementById("effect1");
    var mod2 = document.getElementById("effect2");
    var mod3 = document.getElementById("effect3");

    var reverb = new Tone.PingPongDelay(1, 0.1);

    mod1.oninput = function() {
	reverb.delayTime = mod1.value;
}

var samples=[];

countryList();

function countryList()
{
	var c = document.getElementById('countries');
	
	if (c.value == 0) 
	{
		console.log('Western');
		samples = [
    new Tone.Player({
       "url" : "kick.mp3",
       "retrigger" : true
    }),
    new Tone.Player({
       "url" : "snr.mp3",
       "retrigger" : true
    }),
    new Tone.Player({
       "url" : "hat1.mp3",
       "retrigger" : true
    }),
    new Tone.Player({
       "url" : "tom2.mp3",
       "retrigger" : true
    }),
    new Tone.Player({
       "url" : "tom3.mp3",
       "retrigger" : true
    }),
    new Tone.Player({
       "url" : "tom4.mp3",
       "retrigger" : true
    }),
    new Tone.Player({
       "url" : "crsh1.mp3",
       "retrigger" : true
    })
       ];
       samples[0].volume.value = slider1.value;
       samples[1].volume.value = slider2.value;
       samples[2].volume.value = slider3.value;
       samples[3].volume.value = slider4.value;
       samples[4].volume.value = slider5.value;
       samples[5].volume.value = slider6.value;
       samples[6].volume.value = slider7.value;
       samples.forEach(Player => Player.connect(reverb));
	}
	else if (c.value == 1)
	{
		console.log('African');
		samples = [
    new Tone.Player({
       "url" : "africankick.mp3",
       "retrigger" : true
    }),
    new Tone.Player({
       "url" : "africanrim.mp3",
       "retrigger" : true
    }),
    new Tone.Player({
       "url" : "africanshaker.mp3",
       "retrigger" : true
    }),
    new Tone.Player({
       "url" : "bongo1.mp3",
       "retrigger" : true
    }),
    new Tone.Player({
       "url" : "bongo2.mp3",
       "retrigger" : true
    }),
    new Tone.Player({
       "url" : "conga1.mp3",
       "retrigger" : true
    }),
    new Tone.Player({
       "url" : "africancymbol.mp3",
       "retrigger" : true
    })
       ];
       samples[0].volume.value = slider1.value;
       samples[1].volume.value = slider2.value;
       samples[2].volume.value = slider3.value;
       samples[3].volume.value = slider4.value;
       samples[4].volume.value = slider5.value;
       samples[5].volume.value = slider6.value;
       samples[6].volume.value = slider7.value;
       samples.forEach(Player => Player.connect(reverb));
	}
}

		reverb.connect(Tone.Master);

        const $rows = document.body.querySelectorAll('div > div');

        let index = 0;

        Tone.Transport.scheduleRepeat(repeat, '8n');
        Tone.Transport.start();

        function repeat(){ 
            let step = index % 16;
            for (let i = 0; i < $rows.length; i++){
                let sample = samples[i],
                    $row = $rows[i],
                    $input = $row.querySelector(`input:nth-child(${step + 1})`);
                if ($input.checked) sample.start();
            }
         index++;
     }

     var toggleActions1 = function(event) {

        // set the turntable to run or stop
        // depending on the toggle button value
        if (event.value == 1 ){
            Tone.Transport.start();
        }
        else {
            Tone.Transport.stop();
            index = 0;
            Tone.time = 0;
        }
    }
    /* var mute = function(event){
    	if (event.value = 1) {
    		slider1.value = -48;
    	}
    	else if (event.value = 2) {
    		slider2.value = -48;
    	}
    	else if (event.value = 3) {
    		slider3.value = -48;
    	}
    	else if (event.value = 4) {
    		slider4.value = -48;
    	}
    	else if (event.value = 5) {
    		slider5.value = -48;
    	}
    	else if (event.value = 6) {
    		slider6.value = -48;
    	}
    	else if (event.value = 7) {
    		slider7.value = -48;
    	}

    }*/


/*const synths = [
         new Tone.Synth(),
         new Tone.Synth(),
         new Tone.Synth(),
         new Tone.Synth(),
         new Tone.Synth(),
         new Tone.Synth(),
         new Tone.Synth()
       ];

         synths[0].oscillator.type = 'sine';
         synths[1].oscillator.type = 'sine';
         synths[2].oscillator.type = 'sine';
         synths[3].oscillator.type = 'sine';
         synths[4].oscillator.type = 'sine';
         synths[5].oscillator.type = 'sine';
         synths[6].oscillator.type = 'sine';

         synths.forEach(synth => synth.toMaster());

        const $rows = document.body.querySelectorAll('div > div'),
              notes = ['C3', 'D3', 'E3', 'F3', 'G3', 'A3', 'B3'];
        let index = 0;

        Tone.Transport.scheduleRepeat(repeat, '8n');
        Tone.Transport.start();

        function repeat(time){ 
            let step = index % 8;
            for (let i = 0; i < $rows.length; i++){
                let synth = synths[i],
                    note = notes[i],
                    $row = $rows[i],
                    $input = $row.querySelector(`input:nth-child(${step + 1})`);
                if ($input.checked) synth.triggerAttackRelease(note, '8n', time);
            }
         index++;
        }*/

        /*var toggle = new Nexus.Toggle('#target')

        //controls
        nx.onload = function() {

            toggle.on("*", toggleActions1);
        }

        var toggleActions1 = function(event) {


    }*/
    </script>

</body>
</html>
